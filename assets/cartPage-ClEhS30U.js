import{L as x}from"./LoadingOverlay-kxTLRXG6.js";import{c as _}from"./cartStore-D8mXND9M.js";import{_ as z,m as O,k as G,r as T,o as l,c as d,b as M,a as o,t as i,F as R,j as V,e as C,h as q,l as Q,w as k,d as L,q as H}from"./index-BD1DSNo1.js";import{n as D,d as I,P as X,S as Y,a as J}from"./pagination-DygiP_tu.js";import"./drone_logo3-B-egRVc4.js";function K(t){let{swiper:e,extendParams:A,emit:y,once:$}=t;A({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function a(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function S(){if(e.params.cssMode)return;const{touchEventsData:u,touches:b}=e;u.velocities.length===0&&u.velocities.push({position:b[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:b[e.isHorizontal()?"currentX":"currentY"],time:D()})}function g(u){let{currentPos:b}=u;if(e.params.cssMode)return;const{params:s,wrapperEl:c,rtlTranslate:B,snapGrid:p,touchEventsData:h}=e,U=D()-h.touchStartTime;if(b<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(b>-e.maxTranslate()){e.slides.length<p.length?e.slideTo(p.length-1):e.slideTo(e.slides.length-1);return}if(s.freeMode.momentum){if(h.velocities.length>1){const r=h.velocities.pop(),m=h.velocities.pop(),j=r.position-m.position,N=r.time-m.time;e.velocity=j/N,e.velocity/=2,Math.abs(e.velocity)<s.freeMode.minimumVelocity&&(e.velocity=0),(N>150||D()-r.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=s.freeMode.momentumVelocityRatio,h.velocities.length=0;let f=1e3*s.freeMode.momentumRatio;const F=e.velocity*f;let n=e.translate+F;B&&(n=-n);let P=!1,w;const v=Math.abs(e.velocity)*20*s.freeMode.momentumBounceRatio;let E;if(n<e.maxTranslate())s.freeMode.momentumBounce?(n+e.maxTranslate()<-v&&(n=e.maxTranslate()-v),w=e.maxTranslate(),P=!0,h.allowMomentumBounce=!0):n=e.maxTranslate(),s.loop&&s.centeredSlides&&(E=!0);else if(n>e.minTranslate())s.freeMode.momentumBounce?(n-e.minTranslate()>v&&(n=e.minTranslate()+v),w=e.minTranslate(),P=!0,h.allowMomentumBounce=!0):n=e.minTranslate(),s.loop&&s.centeredSlides&&(E=!0);else if(s.freeMode.sticky){let r;for(let m=0;m<p.length;m+=1)if(p[m]>-n){r=m;break}Math.abs(p[r]-n)<Math.abs(p[r-1]-n)||e.swipeDirection==="next"?n=p[r]:n=p[r-1],n=-n}if(E&&$("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(B?f=Math.abs((-n-e.translate)/e.velocity):f=Math.abs((n-e.translate)/e.velocity),s.freeMode.sticky){const r=Math.abs((B?-n:n)-e.translate),m=e.slidesSizesGrid[e.activeIndex];r<m?f=s.speed:r<2*m?f=s.speed*1.5:f=s.speed*2.5}}else if(s.freeMode.sticky){e.slideToClosest();return}s.freeMode.momentumBounce&&P?(e.updateProgress(w),e.setTransition(f),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating=!0,I(c,()=>{!e||e.destroyed||!h.allowMomentumBounce||(y("momentumBounce"),e.setTransition(s.speed),setTimeout(()=>{e.setTranslate(w),I(c,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(y("_freeModeNoMomentumRelease"),e.updateProgress(n),e.setTransition(f),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,I(c,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(n),e.updateActiveIndex(),e.updateSlidesClasses()}else if(s.freeMode.sticky){e.slideToClosest();return}else s.freeMode&&y("_freeModeNoMomentumRelease");(!s.freeMode.momentum||U>=s.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:a,onTouchMove:S,onTouchEnd:g}})}const W={data(){return{modules:[K,X]}},computed:{...O(_,["cart","loadingStatus","loadingIcon","form","resetUserForm","recommend"]),coupon_code:{get(){return""},set(t){_().coupon_code=t}},enterCoupon(){return this.$t("cart.enterCoupon")}},components:{LoadingOverlay:x,Swiper:Y,SwiperSlide:J},methods:{...G(_,["getCartList","getRecommend"]),increaseQty(t){t.qty+=1,this.updateQty(t)},decreaseQty(t){t.qty-=1,this.updateQty(t)},updateQty(t){if(t.qty<=0||t.qty>99){this.$swal.fire({icon:"error",title:this.$t("cart.enterQuantityRange"),customClass:{title:"swal-title"}}),t.qty=1;return}else if(t.qty.toString().includes(".")){this.$swal.fire({icon:"error",title:this.$t("cart.noDecimalAllowed"),customClass:{title:"swal-title"}}),t.qty=1;return}_().updateQty(t).then(e=>{this.$swal.fire({title:this.$t("cart.cartUpdated"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},delProduct(t){_().delProduct(t).then(e=>{this.$swal.fire({title:this.$t("cart.deleted"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},delAll(){_().delAll().then(t=>{this.$swal.fire({title:this.$t("cart.deleted"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},addCouponCode(){_().addCouponCode().then(t=>{this.$swal.fire({title:this.$t("cart.couponApplied"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})}).catch(()=>{this.$swal.fire({icon:"error",title:this.$t("cart.couponNotFound"),customClass:{title:"swal-title"}})})}},mounted(){this.getRecommend()},watch:{resetUserForm(){this.$refs.form.resetForm()}}},Z={class:"container"},ee={class:"mt-3"},te={class:"mt-3 mb-4"},oe={key:0,class:"alert alert-secondary text-center m-5"},se={key:1,class:"row"},ne={class:"col-lg-8"},ie={class:"table"},ae={scope:"col",class:"border-0 ps-0",width:"35%"},le={scope:"col",class:"border-0 text-center",width:"20%"},re={scope:"col",class:"border-0",width:"25%"},de={scope:"col",class:"border-0",width:"15%"},ce=["disabled"],ue={key:0},me={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},pe=["src"],he={class:"mb-0 fw-bold ms-3 d-inline-block product-title",style:{"font-size":"20px"}},fe={key:0,class:"text-success fs-14 coupon-title"},be={class:"border-0 align-middle"},_e={class:"input-group"},ye={class:"input-group-prepend"},ge=["onClick","disabled"],we=o("i",{class:"fas fa-minus"},null,-1),ve=[we],Te=["onUpdate:modelValue","disabled","onBlur"],Me={class:"input-group-append"},Ce=["onClick","disabled"],ke=o("i",{class:"fas fa-plus"},null,-1),$e=[ke],Se={key:0,class:"border-0 align-middle coupon-price"},Be={class:"text-success"},Pe={class:"mb-0 ms-auto"},Ee={key:1,class:"border-0 align-middle"},Re={class:"mb-0 ms-auto"},De={class:"border-0 align-middle"},Ie=["onClick","disabled"],Ae=["disabled"],Ne={key:0,class:"fas fa-spinner fa-pulse ms-2 loadingIcon"},Ve={class:"input-group mb-3 w-50 couponInput"},qe=["placeholder"],Qe={class:"input-group-append"},Le=o("i",{class:"fas fa-paper-plane"},null,-1),Ue=[Le],Fe={class:"col-lg-4"},je={class:"border p-4 mb-4 bg-light"},xe={class:"fw-bold mb-4"},ze={class:"table text-muted border-bottom"},Oe={scope:"row",class:"border-0 px-0 pt-4 font-weight-normal bg-light"},Ge={class:"text-end border-0 px-0 pt-4 bg-light"},He={scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal bg-light"},Xe=o("td",{class:"text-end border-0 px-0 pt-0 pb-4 bg-light"},"ApplePay",-1),Ye={class:"d-flex justify-content-between mt-4"},Je={class:"mb-0 h4 fw-bold"},Ke={class:"mb-0 h4 fw-bold"},We={key:0,class:"d-flex justify-content-between mt-4"},Ze={class:"mb-0 h4 fw-bold text-success"},et={class:"mb-0 h4 fw-bold text-success"},tt=o("hr",{class:"mt-5"},null,-1),ot=["src"];function st(t,e,A,y,$,a){const S=T("LoadingOverlay"),g=T("RouterLink"),u=T("swiper-slide"),b=T("swiper");return l(),d(R,null,[M(S,{active:t.loadingStatus,"onUpdate:active":e[0]||(e[0]=s=>t.loadingStatus=s),"is-full-page":!0},null,8,["active"]),o("div",Z,[o("div",ee,[o("h3",te,i(t.$t("cart.title")),1),t.cart.carts.length===0?(l(),d("div",oe,i(t.$t("cart.empty")),1)):(l(),d("div",se,[o("div",ne,[o("table",ie,[o("thead",null,[o("tr",null,[o("th",ae,i(t.$t("cart.name")),1),o("th",le,i(t.$t("cart.quantity")),1),o("th",re,i(t.$t("cart.price")),1),o("th",de,[o("div",null,[o("button",{class:"btn p-0 border-0 delAll",type:"button",onClick:e[1]||(e[1]=(...s)=>a.delAll&&a.delAll(...s)),disabled:t.loadingIcon!==""||t.cart.carts.length===0},i(t.$t("cart.clearCart")),9,ce)])])])]),t.cart.carts?(l(),d("tbody",ue,[(l(!0),d(R,null,V(t.cart.carts,s=>(l(),d("tr",{class:"border-bottom border-top",key:s.id},[o("th",me,[o("img",{src:s.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,pe),o("div",he,[L(i(s.product.title)+" ",1),s.coupon?(l(),d("div",fe,i(t.$t("cart.couponApplied"))+"-"+i(s.coupon.title),1)):C("",!0)])]),o("td",be,[o("div",_e,[o("div",ye,[o("button",{class:"btn btn-outline-dark border-0 py-2 m-none",type:"button",id:"button-addon1",onClick:c=>a.decreaseQty(s),disabled:t.loadingIcon!==""},ve,8,ge)]),q(o("input",{type:"number",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:"1","onUpdate:modelValue":c=>s.qty=c,disabled:t.loadingIcon===s.id,onBlur:c=>a.updateQty(s)},null,40,Te),[[Q,s.qty,void 0,{number:!0}]]),o("div",Me,[o("button",{class:"btn btn-outline-dark border-0 py-2 m-none",type:"button",id:"button-addon2",onClick:c=>a.increaseQty(s),disabled:t.loadingIcon!==""},$e,8,Ce)])])]),s.coupon?(l(),d("td",Se,[o("small",Be,i(t.$t("cart.discountPrice"))+"ï¼š",1),o("p",Pe," NT$ "+i(t.$filters.currency(s.final_total)),1)])):(l(),d("td",Ee,[o("p",Re,"NT$ "+i(t.$filters.currency(s.product.price)),1)])),o("td",De,[o("button",{type:"button",class:"btn ms-2",onClick:c=>a.delProduct(s.id),disabled:t.loadingIcon===s.id},[o("i",{class:"fas fa-times",disabled:t.loadingIcon===s.id},null,8,Ae),t.loadingIcon===s.id?(l(),d("i",Ne)):C("",!0)],8,Ie)])]))),128))])):C("",!0)]),o("div",Ve,[q(o("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:a.enterCoupon,"aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":e[2]||(e[2]=s=>a.coupon_code=s)},null,8,qe),[[Q,a.coupon_code]]),o("div",Qe,[o("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:e[3]||(e[3]=(...s)=>a.addCouponCode&&a.addCouponCode(...s))},Ue)])])]),o("div",Fe,[o("div",je,[o("h4",xe,i(t.$t("cart.orderDetails")),1),o("table",ze,[o("tbody",null,[o("tr",null,[o("th",Oe,i(t.$t("common.subtotal")),1),o("td",Ge,"NT$ "+i(t.$filters.currency(t.cart.total)),1)]),o("tr",null,[o("th",He,i(t.$t("cart.paymentMethod")),1),Xe])])]),o("div",Ye,[o("p",Je,i(t.$t("common.total")),1),o("p",Ke,"NT$ "+i(t.$filters.currency(t.cart.total)),1)]),t.cart.total!==t.cart.final_total?(l(),d("div",We,[o("p",Ze,i(t.$t("common.discountPrice")),1),o("p",et,"NT$ "+i(t.$filters.currency(t.cart.final_total)),1)])):C("",!0),M(g,{to:"/checkOut",class:"btn btn-dark w-100 mt-4"},{default:k(()=>[L(i(t.$t("cart.checkout")),1)]),_:1})])])])),tt,o("div",null,[o("h4",null,i(t.$t("cart.moreRecommendations")),1),M(b,{class:"cartSwiper my-4",style:{"--swiper-pagination-color":"#fff"},slidesPerView:3,spaceBetween:20,freeMode:!0,pagination:{clickable:!0},modules:$.modules},{default:k(()=>[(l(!0),d(R,null,V(t.recommend,(s,c)=>(l(),H(u,{class:"cartSwiper-slide row",key:c},{default:k(()=>[M(g,{to:`products/${s.id}`},{default:k(()=>[o("img",{src:s.imageUrl,alt:""},null,8,ot)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1},8,["modules"])])])])],64)}const ct=z(W,[["render",st]]);export{ct as default};
