import{L as z}from"./LoadingOverlay-BcXwnO8M.js";import{c as _}from"./cartStore-BHLEscMG.js";import{_ as O,m as G,k as H,r as M,o as l,c as d,b as C,a as o,t as a,F as R,j as q,e as k,h as Q,l as L,w as $,d as U,q as X,p as Y,f as J}from"./index-DZBj5xd5.js";import{n as D,d as A,P as K,S as W,a as Z}from"./pagination-BlSxpgtu.js";import"./drone_logo3-B-egRVc4.js";function ee(t){let{swiper:e,extendParams:N,emit:g,once:S}=t;N({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function i(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function B(){if(e.params.cssMode)return;const{touchEventsData:u,touches:b}=e;u.velocities.length===0&&u.velocities.push({position:b[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:b[e.isHorizontal()?"currentX":"currentY"],time:D()})}function w(u){let{currentPos:b}=u;if(e.params.cssMode)return;const{params:s,wrapperEl:c,rtlTranslate:P,snapGrid:p,touchEventsData:h}=e,F=D()-h.touchStartTime;if(b<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(b>-e.maxTranslate()){e.slides.length<p.length?e.slideTo(p.length-1):e.slideTo(e.slides.length-1);return}if(s.freeMode.momentum){if(h.velocities.length>1){const r=h.velocities.pop(),m=h.velocities.pop(),x=r.position-m.position,V=r.time-m.time;e.velocity=x/V,e.velocity/=2,Math.abs(e.velocity)<s.freeMode.minimumVelocity&&(e.velocity=0),(V>150||D()-r.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=s.freeMode.momentumVelocityRatio,h.velocities.length=0;let f=1e3*s.freeMode.momentumRatio;const j=e.velocity*f;let n=e.translate+j;P&&(n=-n);let I=!1,v;const T=Math.abs(e.velocity)*20*s.freeMode.momentumBounceRatio;let E;if(n<e.maxTranslate())s.freeMode.momentumBounce?(n+e.maxTranslate()<-T&&(n=e.maxTranslate()-T),v=e.maxTranslate(),I=!0,h.allowMomentumBounce=!0):n=e.maxTranslate(),s.loop&&s.centeredSlides&&(E=!0);else if(n>e.minTranslate())s.freeMode.momentumBounce?(n-e.minTranslate()>T&&(n=e.minTranslate()+T),v=e.minTranslate(),I=!0,h.allowMomentumBounce=!0):n=e.minTranslate(),s.loop&&s.centeredSlides&&(E=!0);else if(s.freeMode.sticky){let r;for(let m=0;m<p.length;m+=1)if(p[m]>-n){r=m;break}Math.abs(p[r]-n)<Math.abs(p[r-1]-n)||e.swipeDirection==="next"?n=p[r]:n=p[r-1],n=-n}if(E&&S("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(P?f=Math.abs((-n-e.translate)/e.velocity):f=Math.abs((n-e.translate)/e.velocity),s.freeMode.sticky){const r=Math.abs((P?-n:n)-e.translate),m=e.slidesSizesGrid[e.activeIndex];r<m?f=s.speed:r<2*m?f=s.speed*1.5:f=s.speed*2.5}}else if(s.freeMode.sticky){e.slideToClosest();return}s.freeMode.momentumBounce&&I?(e.updateProgress(v),e.setTransition(f),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating=!0,A(c,()=>{!e||e.destroyed||!h.allowMomentumBounce||(g("momentumBounce"),e.setTransition(s.speed),setTimeout(()=>{e.setTranslate(v),A(c,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(g("_freeModeNoMomentumRelease"),e.updateProgress(n),e.setTransition(f),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,A(c,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(n),e.updateActiveIndex(),e.updateSlidesClasses()}else if(s.freeMode.sticky){e.slideToClosest();return}else s.freeMode&&g("_freeModeNoMomentumRelease");(!s.freeMode.momentum||F>=s.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:i,onTouchMove:B,onTouchEnd:w}})}const te={data(){return{modules:[ee,K]}},computed:{...G(_,["cart","loadingStatus","loadingIcon","form","resetUserForm","recommend"]),coupon_code:{get(){return""},set(t){_().coupon_code=t}},enterCoupon(){return this.$t("cart.enterCoupon")}},components:{LoadingOverlay:z,Swiper:W,SwiperSlide:Z},methods:{...H(_,["getCartList","getRecommend"]),increaseQty(t){t.qty+=1,this.updateQty(t)},decreaseQty(t){t.qty-=1,this.updateQty(t)},updateQty(t){if(t.qty<=0||t.qty>99){this.$swal.fire({icon:"error",title:this.$t("cart.enterQuantityRange"),customClass:{title:"swal-title"}}),t.qty=1;return}else if(t.qty.toString().includes(".")){this.$swal.fire({icon:"error",title:this.$t("cart.noDecimalAllowed"),customClass:{title:"swal-title"}}),t.qty=1;return}_().updateQty(t).then(e=>{this.$swal.fire({title:this.$t("cart.cartUpdated"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},delProduct(t){_().delProduct(t).then(e=>{this.$swal.fire({title:this.$t("cart.deleted"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},delAll(){_().delAll().then(t=>{this.$swal.fire({title:this.$t("cart.deleted"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})})},addCouponCode(){_().addCouponCode().then(t=>{this.$swal.fire({title:this.$t("cart.couponApplied"),icon:"success",showConfirmButton:!1,timer:1e3,customClass:{title:"swal-title"}})}).catch(()=>{this.$swal.fire({icon:"error",title:this.$t("cart.couponNotFound"),customClass:{title:"swal-title"}})})}},mounted(){this.getRecommend()},watch:{resetUserForm(){this.$refs.form.resetForm()}}},y=t=>(Y("data-v-7af9cf99"),t=t(),J(),t),oe={class:"container"},se={class:"mt-3"},ne={class:"mt-3 mb-4"},ae={key:0,class:"alert alert-secondary text-center m-5"},ie={key:1,class:"row"},le={class:"col-lg-8"},re={class:"table"},de={scope:"col",class:"border-0 ps-0",width:"35%"},ce={scope:"col",class:"border-0 text-center",width:"20%"},ue={scope:"col",class:"border-0",width:"25%"},me={scope:"col",class:"border-0",width:"15%"},pe=["disabled"],he={key:0},fe={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},be=["src"],_e={class:"mb-0 fw-bold ms-3 d-inline-block product-title",style:{"font-size":"20px"}},ye={key:0,class:"text-success fs-14 coupon-title"},ge={class:"border-0 align-middle"},we={class:"input-group"},ve={class:"input-group-prepend"},Te=["onClick","disabled"],Me=y(()=>o("i",{class:"fas fa-minus"},null,-1)),Ce=[Me],ke=["onUpdate:modelValue","disabled","onBlur"],$e={class:"input-group-append"},Se=["onClick","disabled"],Be=y(()=>o("i",{class:"fas fa-plus"},null,-1)),Pe=[Be],Ie={key:0,class:"border-0 align-middle coupon-price"},Ee={class:"text-success"},Re={class:"mb-0 ms-auto"},De={key:1,class:"border-0 align-middle"},Ae={class:"mb-0 ms-auto"},Ne={class:"border-0 align-middle"},Ve=["onClick","disabled"],qe=["disabled"],Qe={key:0,class:"fas fa-spinner fa-pulse ms-2 loadingIcon"},Le={class:"input-group mb-3 w-50 couponInput"},Ue=["placeholder"],Fe={class:"input-group-append"},je=y(()=>o("i",{class:"fas fa-paper-plane"},null,-1)),xe=[je],ze={class:"col-lg-4"},Oe={class:"border p-4 mb-4 bg-light"},Ge={class:"fw-bold mb-4"},He={class:"table text-muted border-bottom"},Xe={scope:"row",class:"border-0 px-0 pt-4 font-weight-normal bg-light"},Ye={class:"text-end border-0 px-0 pt-4 bg-light"},Je={scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal bg-light"},Ke=y(()=>o("td",{class:"text-end border-0 px-0 pt-0 pb-4 bg-light"},"ApplePay",-1)),We={class:"d-flex justify-content-between mt-4"},Ze={class:"mb-0 h4 fw-bold"},et={class:"mb-0 h4 fw-bold"},tt={key:0,class:"d-flex justify-content-between mt-4"},ot={class:"mb-0 h4 fw-bold text-success"},st={class:"mb-0 h4 fw-bold text-success"},nt=y(()=>o("hr",{class:"mt-5"},null,-1)),at=["src"];function it(t,e,N,g,S,i){const B=M("LoadingOverlay"),w=M("RouterLink"),u=M("swiper-slide"),b=M("swiper");return l(),d(R,null,[C(B,{active:t.loadingStatus,"onUpdate:active":e[0]||(e[0]=s=>t.loadingStatus=s),"is-full-page":!0},null,8,["active"]),o("div",oe,[o("div",se,[o("h3",ne,a(t.$t("cart.title")),1),t.cart.carts.length===0?(l(),d("div",ae,a(t.$t("cart.empty")),1)):(l(),d("div",ie,[o("div",le,[o("table",re,[o("thead",null,[o("tr",null,[o("th",de,a(t.$t("cart.name")),1),o("th",ce,a(t.$t("cart.quantity")),1),o("th",ue,a(t.$t("cart.price")),1),o("th",me,[o("div",null,[o("button",{class:"btn p-0 border-0 delAll",type:"button",onClick:e[1]||(e[1]=(...s)=>i.delAll&&i.delAll(...s)),disabled:t.loadingIcon!==""||t.cart.carts.length===0},a(t.$t("cart.clearCart")),9,pe)])])])]),t.cart.carts?(l(),d("tbody",he,[(l(!0),d(R,null,q(t.cart.carts,s=>(l(),d("tr",{class:"border-bottom border-top",key:s.id},[o("th",fe,[o("img",{src:s.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,be),o("div",_e,[U(a(s.product.title)+" ",1),s.coupon?(l(),d("div",ye,a(t.$t("cart.couponApplied"))+"-"+a(s.coupon.title),1)):k("",!0)])]),o("td",ge,[o("div",we,[o("div",ve,[o("button",{class:"btn btn-outline-dark border-0 py-2 m-none",type:"button",id:"button-addon1",onClick:c=>i.decreaseQty(s),disabled:t.loadingIcon!==""},Ce,8,Te)]),Q(o("input",{type:"number",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:"1","onUpdate:modelValue":c=>s.qty=c,disabled:t.loadingIcon===s.id,onBlur:c=>i.updateQty(s)},null,40,ke),[[L,s.qty,void 0,{number:!0}]]),o("div",$e,[o("button",{class:"btn btn-outline-dark border-0 py-2 m-none",type:"button",id:"button-addon2",onClick:c=>i.increaseQty(s),disabled:t.loadingIcon!==""},Pe,8,Se)])])]),s.coupon?(l(),d("td",Ie,[o("small",Ee,a(t.$t("cart.discountPrice"))+"ï¼š",1),o("p",Re," NT$ "+a(t.$filters.currency(s.final_total)),1)])):(l(),d("td",De,[o("p",Ae,"NT$ "+a(t.$filters.currency(s.product.price)),1)])),o("td",Ne,[o("button",{type:"button",class:"btn ms-2",onClick:c=>i.delProduct(s.id),disabled:t.loadingIcon===s.id},[o("i",{class:"fas fa-times",disabled:t.loadingIcon===s.id},null,8,qe),t.loadingIcon===s.id?(l(),d("i",Qe)):k("",!0)],8,Ve)])]))),128))])):k("",!0)]),o("div",Le,[Q(o("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:i.enterCoupon,"aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":e[2]||(e[2]=s=>i.coupon_code=s)},null,8,Ue),[[L,i.coupon_code]]),o("div",Fe,[o("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:e[3]||(e[3]=(...s)=>i.addCouponCode&&i.addCouponCode(...s))},xe)])])]),o("div",ze,[o("div",Oe,[o("h4",Ge,a(t.$t("cart.orderDetails")),1),o("table",He,[o("tbody",null,[o("tr",null,[o("th",Xe,a(t.$t("common.subtotal")),1),o("td",Ye,"NT$ "+a(t.$filters.currency(t.cart.total)),1)]),o("tr",null,[o("th",Je,a(t.$t("cart.paymentMethod")),1),Ke])])]),o("div",We,[o("p",Ze,a(t.$t("common.total")),1),o("p",et,"NT$ "+a(t.$filters.currency(t.cart.total)),1)]),t.cart.total!==t.cart.final_total?(l(),d("div",tt,[o("p",ot,a(t.$t("common.discountPrice")),1),o("p",st,"NT$ "+a(t.$filters.currency(t.cart.final_total)),1)])):k("",!0),C(w,{to:"/checkOut",class:"btn btn-dark w-100 mt-4"},{default:$(()=>[U(a(t.$t("cart.checkout")),1)]),_:1})])])])),nt,o("div",null,[o("h4",null,a(t.$t("cart.moreRecommendations")),1),C(b,{class:"cartSwiper my-4",style:{"--swiper-pagination-color":"#fff"},slidesPerView:3,spaceBetween:20,freeMode:!0,pagination:{clickable:!0},modules:S.modules},{default:$(()=>[(l(!0),d(R,null,q(t.recommend,(s,c)=>(l(),X(u,{class:"cartSwiper-slide row",key:c},{default:$(()=>[C(w,{to:`products/${s.id}`},{default:$(()=>[o("img",{src:s.imageUrl,alt:""},null,8,at)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1},8,["modules"])])])])],64)}const pt=O(te,[["render",it],["__scopeId","data-v-7af9cf99"]]);export{pt as default};
